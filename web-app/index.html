<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Home Purchase Analyzer - Interactive calculator for home buying decisions with investment analysis">
    <title>Home Purchase Analyzer</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <header>
        <h1>Home Purchase Analyzer</h1>
        <nav class="tab-navigation">
            <button class="tab-btn active" data-tab="calculator">Calculator</button>
            <button class="tab-btn" data-tab="compare">Compare</button>
            <button class="tab-btn" data-tab="analysis">Analysis</button>
        </nav>
    </header>

    <main>
        <!-- Tab 1: Calculator -->
        <section id="calculator-tab" class="tab-content active">
            <div class="content-grid">
                <div class="input-section">
                    <h2>Property Information</h2>
                    <form id="property-form">
                        <div class="form-group">
                            <label for="purchase-price">Purchase Price ($)</label>
                            <input type="number" id="purchase-price" name="purchasePrice" min="0" step="1000" value="400000" required>
                        </div>

                        <div class="form-group">
                            <label for="down-payment-percent">Down Payment (%)</label>
                            <div class="slider-group">
                                <input type="range" id="down-payment-percent" name="downPaymentPercent" min="0" max="100" step="1" value="20">
                                <input type="number" id="down-payment-percent-number" min="0" max="100" step="0.1" value="20">
                                <span>%</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="down-payment-amount">Down Payment ($)</label>
                            <input type="number" id="down-payment-amount" name="downPaymentAmount" readonly>
                        </div>

                        <div class="form-group">
                            <label for="interest-rate">Interest Rate (%)</label>
                            <input type="number" id="interest-rate" name="interestRate" min="0" max="20" step="0.01" value="6.5" required>
                        </div>

                        <div class="form-group">
                            <label for="loan-term">Loan Term (years)</label>
                            <select id="loan-term" name="loanTerm" required>
                                <option value="10">10 years</option>
                                <option value="15">15 years</option>
                                <option value="20">20 years</option>
                                <option value="25">25 years</option>
                                <option value="30" selected>30 years</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="property-tax">Monthly Property Tax ($)</label>
                            <input type="number" id="property-tax" name="propertyTax" min="0" step="10" value="400" required>
                        </div>

                        <div class="form-group">
                            <label for="insurance">Monthly Homeowners Insurance ($)</label>
                            <input type="number" id="insurance" name="insurance" min="0" step="10" value="150" required>
                        </div>

                        <div class="form-group">
                            <label for="hoa">Monthly HOA/Condo Fees ($)</label>
                            <input type="number" id="hoa" name="hoa" min="0" step="10" value="0">
                        </div>

                        <div class="form-group">
                            <label for="utilities">Estimated Monthly Utilities ($)</label>
                            <input type="number" id="utilities" name="utilities" min="0" step="10" value="200">
                        </div>

                        <div class="form-group">
                            <label for="maintenance">Estimated Monthly Maintenance ($)</label>
                            <input type="number" id="maintenance" name="maintenance" min="0" step="10" value="333">
                            <small>Rule of thumb: 1% of home value annually</small>
                        </div>
                    </form>

                    <h2>Income & Investment</h2>
                    <form id="income-form">
                        <div class="form-group">
                            <label for="annual-income">Annual Gross Income ($)</label>
                            <input type="number" id="annual-income" name="annualIncome" min="0" step="1000" value="100000" required>
                        </div>

                        <div class="form-group">
                            <label for="monthly-debts">Current Monthly Debt Payments ($)</label>
                            <input type="number" id="monthly-debts" name="monthlyDebts" min="0" step="10" value="500">
                        </div>

                        <div class="form-group">
                            <label for="investment-return">Expected Investment Return (%)</label>
                            <input type="number" id="investment-return" name="investmentReturn" min="0" max="20" step="0.1" value="8.0" required>
                            <small>Historical stock market average: 7-10%</small>
                        </div>

                        <div class="form-group">
                            <label for="current-portfolio">Current Investment Portfolio ($)</label>
                            <input type="number" id="current-portfolio" name="currentPortfolio" min="0" step="1000" value="50000">
                        </div>
                    </form>

                    <div class="button-group">
                        <button id="calculate-btn" class="btn btn-primary">Calculate</button>
                        <button id="save-scenario-btn" class="btn btn-secondary">Save Scenario</button>
                    </div>
                </div>

                <div class="results-section">
                    <div class="summary-cards" id="summary-cards">
                        <div class="card">
                            <h3>Monthly Payment</h3>
                            <p class="card-value" id="monthly-payment">-</p>
                            <p class="card-detail" id="monthly-payment-detail">Principal & Interest + PMI</p>
                        </div>

                        <div class="card">
                            <h3>Total Monthly Cost</h3>
                            <p class="card-value" id="total-monthly-cost">-</p>
                            <p class="card-detail">Including all expenses</p>
                        </div>

                        <div class="card">
                            <h3>Affordability</h3>
                            <p class="card-value" id="affordability-ratio">-</p>
                            <p class="card-detail" id="affordability-status">-</p>
                            <div class="progress-bar">
                                <div class="progress-fill" id="affordability-progress"></div>
                            </div>
                        </div>

                        <div class="card">
                            <h3>Down Payment Opportunity Cost</h3>
                            <p class="card-value" id="opportunity-cost">-</p>
                            <p class="card-detail">If invested instead (10 years)</p>
                        </div>
                    </div>

                    <div class="chart-container">
                        <h3>Monthly Payment Breakdown</h3>
                        <canvas id="payment-breakdown-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab 2: Compare -->
        <section id="compare-tab" class="tab-content">
            <div class="scenario-selector">
                <h2>Saved Scenarios</h2>
                <div id="scenario-list" class="scenario-list">
                    <p class="empty-state">No saved scenarios yet. Calculate and save a scenario to get started.</p>
                </div>
                <div class="button-group">
                    <button id="compare-scenarios-btn" class="btn btn-primary">Compare Selected</button>
                    <button id="export-scenarios-btn" class="btn btn-secondary">Export Data</button>
                </div>
            </div>

            <div id="comparison-results" class="comparison-results" style="display: none;">
                <h2>Scenario Comparison</h2>
                <div class="comparison-table-container">
                    <table id="comparison-table" class="comparison-table">
                        <!-- Dynamically generated -->
                    </table>
                </div>

                <div class="chart-container">
                    <h3>Monthly Cost Comparison</h3>
                    <canvas id="comparison-chart"></canvas>
                </div>
            </div>
        </section>

        <!-- Tab 3: Analysis -->
        <section id="analysis-tab" class="tab-content">
            <div class="analysis-controls">
                <h2>Long-term Analysis</h2>

                <div class="form-group">
                    <label for="analysis-scenario-select">Analyze Scenario</label>
                    <select id="analysis-scenario-select">
                        <option value="">-- Select a saved scenario or use Calculator data --</option>
                    </select>
                    <small>Select a saved scenario to analyze, or use the current Calculator data</small>
                </div>

                <div class="controls-grid">
                    <div class="form-group">
                        <label for="timeframe">Timeframe (years)</label>
                        <div class="preset-buttons">
                            <button class="preset-btn" data-years="1">1yr</button>
                            <button class="preset-btn" data-years="5">5yr</button>
                            <button class="preset-btn" data-years="10">10yr</button>
                            <button class="preset-btn" data-years="20">20yr</button>
                            <button class="preset-btn active" data-years="30">30yr</button>
                        </div>
                        <input type="number" id="timeframe" min="1" max="40" value="30">
                    </div>

                    <div class="form-group">
                        <label for="appreciation-rate">Home Appreciation Rate (%)</label>
                        <div class="slider-group">
                            <input type="range" id="appreciation-rate" min="0" max="10" step="0.1" value="3">
                            <input type="number" id="appreciation-rate-number" min="0" max="10" step="0.1" value="3">
                            <span>%</span>
                        </div>
                    </div>
                </div>

                <button id="update-analysis-btn" class="btn btn-primary">Update Analysis</button>
            </div>

            <div class="analysis-grid">
                <div class="chart-container">
                    <h3>Equity Buildup Over Time</h3>
                    <canvas id="equity-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>Investment vs Down Payment</h3>
                    <canvas id="investment-chart"></canvas>
                    <p class="chart-note">Compares home equity vs. investing down payment</p>
                </div>

                <div class="chart-container">
                    <h3>Net Worth Impact</h3>
                    <canvas id="networth-chart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>Cash Flow Analysis</h3>
                    <canvas id="cashflow-chart"></canvas>
                </div>
            </div>

            <div class="house-price-comparison">
                <h2>Comprehensive House Comparison</h2>
                <p class="section-description">Compare two saved scenarios to understand the full financial impact on your wealth, savings, and lifestyle</p>

                <div class="comparison-inputs">
                    <div class="house-input-panel">
                        <h3>Scenario A</h3>
                        <div class="form-group">
                            <label for="scenario-a-select">Select Saved Scenario</label>
                            <select id="scenario-a-select">
                                <option value="">-- Select a scenario --</option>
                            </select>
                        </div>
                        <div id="scenario-a-summary" class="scenario-summary"></div>
                    </div>

                    <div class="house-input-panel">
                        <h3>Scenario B</h3>
                        <div class="form-group">
                            <label for="scenario-b-select">Select Saved Scenario</label>
                            <select id="scenario-b-select">
                                <option value="">-- Select a scenario --</option>
                            </select>
                        </div>
                        <div id="scenario-b-summary" class="scenario-summary"></div>
                    </div>
                </div>

                <div class="comparison-additional-inputs">
                    <h3>Additional Financial Details</h3>
                    <div class="controls-grid">
                        <div class="form-group">
                            <label for="monthly-other-expenses">Monthly Non-Housing Expenses ($)</label>
                            <input type="number" id="monthly-other-expenses" min="0" step="100" value="2500">
                            <small>Food, transportation, utilities (non-home), entertainment, etc.</small>
                        </div>

                        <div class="form-group">
                            <label for="savings-rate">Savings Rate (% of discretionary income)</label>
                            <div class="slider-group">
                                <input type="range" id="savings-rate" min="0" max="100" step="5" value="50">
                                <input type="number" id="savings-rate-number" min="0" max="100" step="1" value="50">
                                <span>%</span>
                            </div>
                            <small>Percentage of leftover money that goes to investments</small>
                        </div>

                        <div class="form-group">
                            <label for="retirement-age">Target Retirement Age</label>
                            <input type="number" id="retirement-age" min="30" max="80" step="1" value="65">
                        </div>

                        <div class="form-group">
                            <label for="current-age">Current Age</label>
                            <input type="number" id="current-age" min="18" max="75" step="1" value="30">
                        </div>

                        <div class="form-group">
                            <label for="savings-milestone">Savings Milestone Goal ($)</label>
                            <input type="number" id="savings-milestone" min="0" step="10000" value="500000">
                            <small>Track time to reach this savings goal</small>
                        </div>
                    </div>
                </div>

                <button id="compare-houses-btn" class="btn btn-primary">Run Comprehensive Comparison</button>

                <div id="comparison-results-section" style="display: none;">
                    <h3>Financial Impact Comparison</h3>

                    <div class="comparison-summary">
                        <div class="card">
                            <h4>Annual Housing Cost</h4>
                            <p class="card-value" id="annual-cost-a">-</p>
                            <p class="card-detail" id="scenario-a-name">Scenario A</p>
                        </div>
                        <div class="card">
                            <h4>Annual Housing Cost</h4>
                            <p class="card-value" id="annual-cost-b">-</p>
                            <p class="card-detail" id="scenario-b-name">Scenario B</p>
                        </div>
                        <div class="card">
                            <h4>Annual Cost Difference</h4>
                            <p class="card-value" id="annual-cost-diff">-</p>
                            <p class="card-detail" id="cost-diff-winner">-</p>
                        </div>
                    </div>

                    <div class="comparison-summary">
                        <div class="card">
                            <h4>Monthly Discretionary Income</h4>
                            <p class="card-value" id="discretionary-a">-</p>
                            <p class="card-detail">Scenario A after all expenses</p>
                        </div>
                        <div class="card">
                            <h4>Monthly Discretionary Income</h4>
                            <p class="card-value" id="discretionary-b">-</p>
                            <p class="card-detail">Scenario B after all expenses</p>
                        </div>
                        <div class="card">
                            <h4>Discretionary Difference</h4>
                            <p class="card-value" id="discretionary-diff">-</p>
                            <p class="card-detail" id="discretionary-winner">-</p>
                        </div>
                    </div>

                    <div class="comparison-summary">
                        <div class="card">
                            <h4>Monthly to Investments</h4>
                            <p class="card-value" id="investment-contribution-a">-</p>
                            <p class="card-detail">Scenario A contributions</p>
                        </div>
                        <div class="card">
                            <h4>Monthly to Investments</h4>
                            <p class="card-value" id="investment-contribution-b">-</p>
                            <p class="card-detail">Scenario B contributions</p>
                        </div>
                        <div class="card">
                            <h4>Investment Difference</h4>
                            <p class="card-value" id="investment-contribution-diff">-</p>
                            <p class="card-detail" id="investment-winner">-</p>
                        </div>
                    </div>

                    <div class="comparison-summary">
                        <div class="card">
                            <h4>Total Net Worth at <span id="comparison-timeframe">30</span> Years</h4>
                            <p class="card-value" id="networth-winner">-</p>
                            <p class="card-detail" id="networth-diff">-</p>
                        </div>
                        <div class="card">
                            <h4>Break-even Point</h4>
                            <p class="card-value" id="breakeven-year">-</p>
                            <p class="card-detail">When net worth equalizes</p>
                        </div>
                        <div class="card">
                            <h4>Savings Goal Timeline</h4>
                            <p class="card-value" id="milestone-diff">-</p>
                            <p class="card-detail" id="milestone-detail">-</p>
                        </div>
                    </div>

                    <div class="comparison-summary">
                        <div class="card">
                            <h4>Retirement Portfolio Impact</h4>
                            <p class="card-value" id="retirement-diff">-</p>
                            <p class="card-detail" id="retirement-detail">-</p>
                        </div>
                        <div class="card">
                            <h4>Financial Freedom Score</h4>
                            <p class="card-value" id="freedom-score-diff">-</p>
                            <p class="card-detail">Years to financial independence</p>
                        </div>
                        <div class="card">
                            <h4>Savings Milestone Timeline</h4>
                            <p class="card-value" id="milestone-diff">-</p>
                            <p class="card-detail" id="milestone-detail">-</p>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Total Wealth Comparison</h3>
                    <canvas id="house-comparison-chart"></canvas>
                    <p class="chart-note">Includes home equity + investment portfolio from savings</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p class="disclaimer">
            <strong>Disclaimer:</strong> This tool provides estimates for educational purposes only.
            Actual costs, rates, and returns may vary. Consult with financial advisors and mortgage
            professionals for actual lending terms and investment advice.
        </p>
        <p class="credits">
            Home Purchase Analyzer | Built with Chart.js
        </p>
    </footer>

    <!-- Hidden file input for import -->
    <input type="file" id="import-file-input" accept=".json" style="display: none;">

    <script src="js/calculator.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
